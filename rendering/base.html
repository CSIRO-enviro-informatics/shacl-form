{% macro display_property(property) %}
{%- include "property.html" %}
{%- endmacro %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Create New {{ form_name }}</title>
</head>
<body>
    <h1>Create New {{ form_name }}</h1>
    <form id="form">
        {%- for group in shape["groups"] %}
        <fieldset>
            <legend>{{ group["label"] }}</legend>
            {%- for property in group["properties"] %}
                {{ display_property(property)|indent(16) }}
            {%- endfor %}
        </fieldset>
        {%- endfor %}
        {%- for property in shape["properties"] %}
            {{ display_property(property)|indent(12) }}
        {%- endfor %}
        <input type="submit" value="Submit" />
    </form>
</body>
</html>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.17.0/dist/jquery.validate.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.17.0/dist/additional-methods.js"></script>
<script>
    {#- Disabled fields are not validated #}
    $("#form").validate({ ignore: ":input[disabled]", equalTo: ":input[equalTo]" });
    {%- for property in shape["properties"] %}
    {#- Add pattern rule #}
    {%- if "pattern" in property %}
    $("#" + $.escapeSelector("{{ property["path"] }}")).rules("add", {
        pattern: /{{ property["pattern"] }}/{{ property["flags"] }}
    });
    {%- endif %}
    {%- endfor %}
    {%- for group in shape["groups"] %} {% for property in group["properties"] %}
    {#- Add pattern rule #}
    {%- if "pattern" in property %}
    $("#" + $.escapeSelector("{{ property["path"] }}")).rules("add", {
        pattern: /{{ property["pattern"] }}/{{ property["flags"] }}
    });
    {%- endif %}
    {%- endfor %}
    {%- endfor %}
</script>